<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/251d1f2705f0ed36.css" as="style"/><link rel="stylesheet" href="/_next/static/css/251d1f2705f0ed36.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-ed57d516f7b4f809.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-a054bbf31fb90f6a.js" defer=""></script><script src="/_next/static/chunks/pages/_app-3504ce18beb57888.js" defer=""></script><script src="/_next/static/chunks/655-a833c80aba5a2ed9.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5BpostId%5D-c88ac0f0779de893.js" defer=""></script><script src="/_next/static/K1CNs86QEQb419ZsPasnT/_buildManifest.js" defer=""></script><script src="/_next/static/K1CNs86QEQb419ZsPasnT/_ssgManifest.js" defer=""></script><script src="/_next/static/K1CNs86QEQb419ZsPasnT/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><style data-emotion="css tlc243">.css-tlc243{color:#333;}</style><div class="css-tlc243"><style data-emotion="css nmrzmf">.css-nmrzmf{border-bottom:1px solid #0C8346;}.css-nmrzmf.header-get-on{z-index:10;position:fixed;top:0;width:100%;}</style><header class=" css-nmrzmf"><style data-emotion="css tuhu7l">.css-tuhu7l{padding:7px 8px;background:#fff;}.css-tuhu7l .navbar-container{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin-left:auto;margin-right:auto;width:100%;}.css-tuhu7l .navbar-blog-name{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-style:italic;font-size:20px;color:#333;font-weight:bold;white-space:nowrap;}.css-tuhu7l .navbar-blog-name:hover{font-style:normal;}.css-tuhu7l .navbar-dropdown-button{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-left:12px;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;padding:0 4px;}@media(min-width: 768px){.css-tuhu7l .navbar-dropdown-button{display:none;}}.css-tuhu7l .navbar-menu-list-wrapper{width:100%;margin-bottom:-6px;}@media(min-width: 768px){.css-tuhu7l .navbar-menu-list-wrapper{border:0;display:block;width:auto;margin-bottom:0;}}.css-tuhu7l .navbar-menu-list-wrapper .navbar-menu-list{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;font-size:14px;margin:16px -8px 0 -8px;}.css-tuhu7l .navbar-menu-list-wrapper .navbar-menu-list .navbar-menu:not(:first-of-type){border-top:1px solid #0C8346;}@media(min-width: 768px){.css-tuhu7l .navbar-menu-list-wrapper .navbar-menu-list{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;margin:0;font-size:14px;line-height:20px;}.css-tuhu7l .navbar-menu-list-wrapper .navbar-menu-list .navbar-menu:not(:first-of-type){border-top:0;border-left:1px solid #0C8346;}}</style><nav class="css-tuhu7l"><div class="navbar-container"><a class="navbar-blog-name" href="/">MERRI`s DEVELOG</a><button type="button" class="navbar-dropdown-button"><span class="sr-only">Open blog menu</span>📚</button><style data-emotion="css 1hyfx7x">.css-1hyfx7x{display:none;}</style><div class="navbar-menu-list-wrapper css-1hyfx7x"><ul class="navbar-menu-list"><style data-emotion="css nvv0w9">@media(min-width: 768px){.css-nvv0w9{padding:10px 20px 7px;margin:-10px 0 -10px -1px;}.css-nvv0w9.active-link-home{padding-bottom:12px;}}</style><li class="navbar-menu css-nvv0w9"></li><style data-emotion="css e7ia66">.css-e7ia66:hover{background:#8FD5A6;transition-duration:500ms;}.css-e7ia66:hover .navbar-menu-link,.css-e7ia66:hover .navbar-menu a{color:#333;}</style><style data-emotion="css 19x6ejr">@media(min-width: 768px){.css-19x6ejr{padding:10px 20px 7px;margin:-10px 0 -10px -1px;}.css-19x6ejr.active-link-home{padding-bottom:12px;}}.css-19x6ejr:hover{background:#8FD5A6;transition-duration:500ms;}.css-19x6ejr:hover .navbar-menu-link,.css-19x6ejr:hover .navbar-menu a{color:#333;}</style><li class="navbar-menu true css-19x6ejr"><style data-emotion="css mnwgy4">.css-mnwgy4{border-bottom:6px solid #E5C2C0;}</style><style data-emotion="css 4xdf42">.css-4xdf42{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;padding:9px 16px 9px 12px;width:100%;border-bottom:6px solid #E5C2C0;}.css-4xdf42:hover{border:1 solid #8FD5A6;color:#333;transition-duration:500ms;}@media(min-width: 768px){.css-4xdf42{padding:16px 12px 7px;margin:-14px -20px -7px;width:auto;}}</style><button data-dropdown-for="dropdown_Blog" class="css-4xdf42">Blog<!-- --> 📔</button><style data-emotion="css ewer5w">.css-ewer5w{display:none;}</style><style data-emotion="css j3irkc">.css-j3irkc{background:#fff;border:1px solid #0C8346;margin:8px 20px;position:relative;width:auto;z-index:0;display:none;}@media(min-width: 768px){.css-j3irkc{margin:6px;position:absolute;z-index:10;}}.css-j3irkc .dropdown-menu-list{font-size:14px;padding:4px 0;}.css-j3irkc .dropdown-menu-list .dropdown-menu-list-part-name{color:#333;font-size:12px;font-weight:bold;padding-left:8px;}.css-j3irkc .dropdown-menu-list li{border:0;}.css-j3irkc .dropdown-menu-list a{display:block;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;padding:8px 16px;}.css-j3irkc .dropdown-menu-list a:hover{background:#8FD5A6;color:#fff;transition-duration:300ms;}.css-j3irkc .dropdown-menu-list .dropdown-menu-active-link{background:#E5C2C0;}.css-j3irkc ul:not(:first-of-type){border-top:1px solid #8FD5A6;}</style><div id="dropdown_Blog" class="css-j3irkc"><ul class="dropdown-menu-list"><span class="dropdown-menu-list-part-name">SW</span><li><a class="" href="/blog/category/design%20pattern">Design pattern</a></li></ul><ul class="dropdown-menu-list"><span class="dropdown-menu-list-part-name">FRONTEND</span><li><a class="" href="/blog/category/javascript">Javascript</a></li></ul><ul class="dropdown-menu-list"><span class="dropdown-menu-list-part-name">TOOL</span><li><a class="" href="/blog/category/git">Git</a></li></ul><ul class="dropdown-menu-list"><span class="dropdown-menu-list-part-name">OS</span><li><a class="" href="/blog/category/linux">Linux</a></li></ul><ul class="dropdown-menu-list"><span class="dropdown-menu-list-part-name">BACKEND</span><li><a class="" href="/blog/category/spring">Spring</a></li><li><a class="" href="/blog/category/java">Java</a></li></ul><ul class="dropdown-menu-list"><span class="dropdown-menu-list-part-name">IDEA</span><li><a class="" href="/blog/category/intellij">Intellij</a></li></ul></div></li><li class="navbar-menu true css-19x6ejr"><style data-emotion="css a3e3m7">.css-a3e3m7{cursor:pointer;display:block;padding:8px 16px 8px 12px;}@media(min-width: 768px){.css-a3e3m7{padding-bottom:7px;padding-top:7px;padding-right:12px;margin:-7px -20px;}}.css-a3e3m7.navbar-menu-active-link{border-bottom:6px solid transparent;border-image:linear-gradient(to right, #E5C2C0 25%, #fff 25%) 1 100%;border-image-slice:1;}@media(min-width: 768px){.css-a3e3m7.navbar-menu-active-link{border-image:linear-gradient(to right, #E5C2C0 100%, #fff) 1 100%;border-image-slice:1;}}</style><a class="navbar-menu-link  css-a3e3m7">Portfolio<!-- --> 📄</a></li><li class="navbar-menu true css-19x6ejr"><a class="navbar-menu-link  css-a3e3m7">About<!-- --> 📄</a></li><li class="navbar-menu css-nvv0w9"></li></ul></div></div></nav></header><style data-emotion="css 1ho3vgx">.css-1ho3vgx{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}.css-1ho3vgx .main-area{-webkit-flex:none;-ms-flex:none;flex:none;margin:16px 0;width:100%;}@media(min-width: 1024px){.css-1ho3vgx .main-area{width:1000px;margin:16px 12px;}}</style><div class="css-1ho3vgx"><style data-emotion="css 1hten03">.css-1hten03{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;height:100%;width:8px;}</style><div class="css-1hten03"></div><main class="main-area"><style data-emotion="css fu7cl3">.css-fu7cl3{border:0;margin:-16px 0;}@media(min-width: 1024px){.css-fu7cl3{border-left:1px solid #0C8346;border-right:1px solid #0C8346;margin-left:0;margin-right:0;}}.css-fu7cl3 .markdown-body{padding:12px 20px;}@media(min-width: 1024px){.css-fu7cl3 .markdown-body{padding-left:16px;padding-right:16px;}}.css-fu7cl3 .end-of-post{color:#329F5B;padding:8px 8px0 8px;}@media(min-width: 1024px){.css-fu7cl3 .end-of-post{padding-left:0;padding-right:0;}}</style><div class="css-fu7cl3"><style data-emotion="css ao9izc">.css-ao9izc{border-bottom:1px solid #0C8346;padding:8px;}.css-ao9izc h1{color:#333;padding-bottom:4px;}.css-ao9izc div{color:#aaa;font-size:14px;}</style><header class="css-ao9izc"><h1>What happens when jdk compiles the generic type &lt;T&gt;</h1><div>2022-08-16</div></header><style data-emotion="css srs5r4">.css-srs5r4{padding:8px;}.css-srs5r4 div{font-size:14px;}</style><div class="css-srs5r4"><div>📂 <!-- -->backend &gt; java</div><div>🧶 #<!-- -->Generic #Type Erasure #ClassCastException</div></div><main class="markdown-body"><h2><code>ClassCastException</code> does not occur when cast to a different type from the type passed to generic <code>&lt;T&gt;</code></h2>
<h3>문제가 발생했던 코드</h3>
<pre><code class="language-java">public static &lt;T&gt; T getData(MyObject myObject, Class&lt;T&gt; resultType) throws CustomException{
  JSONParser parser = new JSONParser();
  JSONObject result;
  T data;
  
  try{
    result = (JSONObject) parser.parse(myObject.getPayload());
    data = (T) result.get(&quot;data&quot;);
  } catch(ParseException e) {
    e.printStackTrace();
    throw new CustomException(404, e.getMessage());
  } catch(ClassCastException e){
    throw new CustomException(500, e.getMessage());
  }
  
  return data;
}
</code></pre>
<ul>
<li><code>data = (T) result.get(&quot;data&quot;);</code> 이 부분에서 resultType으로 넘긴 것과 실제 &quot;data&quot;의 타입이 다르면,<br/>
<!-- -->catch 구문에서 <code>ClassCastException</code> 예외 처리를 한 뒤 메소드를 호출한 곳에서 CustomException이 발생할 것이라고 예상했음.<br/>
<!-- -->하지만 실행해보니 메소드를 호출한 곳에서 <code>ClassCastException</code> 예외가 발생.</li>
</ul>
<h3>Generic <code>&lt;T&gt;</code>가 컴파일 될 때</h3>
<ul>
<li><a href="https://docs.oracle.com/javase/tutorial/java/generics/erasure.html">Generic Type Erasure</a>
<pre><code class="language-plain">Generics were introduced to the Java language to provide tighter type checks at compile time and to support generic programming.  
To implement generics, the Java compiler applies type erasure to:

- Replace all type parameters in generic types with their bounds or Object if the type parameters are unbounded.
  The produced bytecode, therefore, contains only ordinary classes, interfaces, and methods.
- Insert type casts if necessary to preserve type safety.
- Generate bridge methods to preserve polymorphism in extended generic types.

Type erasure ensures that no new classes are created for parameterized types;  
consequently, generics incur no runtime overhead.
</code></pre>
<ul>
<li>첫번째 규칙 : java code가 컴파일 될 때, unbound 상태인 파라미터이면 Object로 bound된 파라미터면 bound class로 변경됨.<!-- -->
<ul>
<li>code 출처 : <a href="https://docs.oracle.com/javase/tutorial/java/generics/genTypes.html">Oracle docs</a></li>
</ul>
<pre><code class="language-java">//before compile
public class Node&lt;T&gt; {
  private T data;
  private Node&lt;T&gt; next;

  public Node(T data, Node&lt;T&gt; next){
    this.data = data;
    this.next = next;
  }

  public T getData(){
    return data;
  }
}
//after compile
public class Node {
  private Object data;
  private Node next;

  public Node(Object data, Node next){
    this.data = data;
    this.next = next;
  }

  public Object getData(){
    return data;
  }
}
</code></pre>
<ul>
<li>이 규칙에 의해 내가 처음 작성했던 코드가 컴파일 이후에는 <code>(Object)</code> 이런식으로 캐스팅하도록 변경됨을 알았음
이때, Object는 java 모든 클래스의 상위 클래스이기 때문에 원래 의도하던 객체가 아닌 String이 리턴된다고 해도 예외가 발생할리가 없었다.</li>
</ul>
</li>
<li>두번째 규칙 : type 안정성을 지키기 위해서 type cast를 추가해준다
이 경우 <code>data = (T) result.get(&quot;data&quot;);</code> 대신 <code>data = (String) result.get(&quot;data&quot;);</code> 과 같이 명시적 형변환 할 때 타입을 명시하라는 의도이지만<br/>
<!-- -->내가 작성되는 메소드의 리턴 데이터 타입을 이 곳에 명시할 수는 없어서 최종적으로 다음 챕터 코드처럼 수정했음</li>
</ul>
</li>
</ul>
<h3>수정한 코드</h3>
<pre><code class="language-java">public static &lt;T&gt; T getData(MyObject myObject, Class&lt;T&gt; resultType) throws CustomException{
  JSONParser parser = new JSONParser();
  JSONObject result;
  T data;

  try{
    result = (JSONObject) parser.parse(myObject.getPayload());
    data = resultType.cast(result.get(&quot;data&quot;));
  } catch(ParseException e) {
    e.printStackTrace();
    throw new CustomException(404, e.getMessage());
  } catch(ClassCastException e){
    throw new CustomException(500, e.getMessage());
  }

  return data;
}
</code></pre>
<hr/>
<p>Generic에 대해서 분명히 취업전에 공부했는데, 막상 실제 업무 코드에 적용하는 것도 그렇고 컴파일 뒤에 어떻게 되는지도 그렇고<br/>
<!-- -->아직 알아야할 것이 많음을 느꼈다.</p></main><div class="end-of-post">/end of <!-- -->What happens when jdk compiles the generic type &lt;T&gt;</div><style data-emotion="css 1mkbknt">.css-1mkbknt{border-top:1px solid #0C8346;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:4px 8px 5px;}@media(min-width: 768px){.css-1mkbknt{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}}@media(min-width: 1024px){.css-1mkbknt{padding-left:0;padding-right:0;}}.css-1mkbknt div:first-of-type{-webkit-flex:1 1 0%;-ms-flex:1 1 0%;flex:1 1 0%;}.css-1mkbknt div:last-of-type{text-align:right;}</style><footer class="css-1mkbknt"><div><style data-emotion="css 173eilp">.css-173eilp{cursor:pointer;padding-left:4px;}.css-173eilp:hover{color:#aaa;}</style><a class="css-173eilp">👈 Linux에서 .conf 파일의 주석으로 사용 가능한 문자열</a></div><div><a class="css-173eilp">Ubuntu 명령어 정리 👉</a></div></footer></div></main><div class="css-1hten03"></div></div><style data-emotion="css 9m6uqx">.css-9m6uqx{background:#fff;border-top:1px solid #0C8346;color:#333;font-size:13px;letter-spacing:-0.01em;padding:11px;}.css-9m6uqx div:not(:first-of-type){padding:4px 0 0;}.css-9m6uqx svg{display:inline;vertical-align:middle;}.css-9m6uqx a:hover{color:#E5C2C0;}.css-9m6uqx.fixed-bottom{bottom:0;position:fixed;width:100%;}</style><footer class=" css-9m6uqx"><div><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path></svg> m3rri17@gmail.com</div><div><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg><a target="_blank" href="https://github.com/m3rri"> https://github.com/m3rri</a></div><div>© 2022-<!-- -->2023<!-- --> KimHyeRi. All rights reserved.</div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"id":"20220816","content":"\n## `ClassCastException` does not occur when cast to a different type from the type passed to generic `\u003cT\u003e`\n### 문제가 발생했던 코드\n```java\npublic static \u003cT\u003e T getData(MyObject myObject, Class\u003cT\u003e resultType) throws CustomException{\n  JSONParser parser = new JSONParser();\n  JSONObject result;\n  T data;\n  \n  try{\n    result = (JSONObject) parser.parse(myObject.getPayload());\n    data = (T) result.get(\"data\");\n  } catch(ParseException e) {\n    e.printStackTrace();\n    throw new CustomException(404, e.getMessage());\n  } catch(ClassCastException e){\n    throw new CustomException(500, e.getMessage());\n  }\n  \n  return data;\n}\n```\n- `data = (T) result.get(\"data\");` 이 부분에서 resultType으로 넘긴 것과 실제 \"data\"의 타입이 다르면,  \n  catch 구문에서 `ClassCastException` 예외 처리를 한 뒤 메소드를 호출한 곳에서 CustomException이 발생할 것이라고 예상했음.  \n  하지만 실행해보니 메소드를 호출한 곳에서 `ClassCastException` 예외가 발생.\n\n### Generic `\u003cT\u003e`가 컴파일 될 때\n- [Generic Type Erasure](https://docs.oracle.com/javase/tutorial/java/generics/erasure.html)\n  ```plain\n  Generics were introduced to the Java language to provide tighter type checks at compile time and to support generic programming.  \n  To implement generics, the Java compiler applies type erasure to:\n\n  - Replace all type parameters in generic types with their bounds or Object if the type parameters are unbounded.\n    The produced bytecode, therefore, contains only ordinary classes, interfaces, and methods.\n  - Insert type casts if necessary to preserve type safety.\n  - Generate bridge methods to preserve polymorphism in extended generic types.\n\n  Type erasure ensures that no new classes are created for parameterized types;  \n  consequently, generics incur no runtime overhead.\n  ```\n  - 첫번째 규칙 : java code가 컴파일 될 때, unbound 상태인 파라미터이면 Object로 bound된 파라미터면 bound class로 변경됨.  \n    - code 출처 : [Oracle docs](https://docs.oracle.com/javase/tutorial/java/generics/genTypes.html)\n    ```java\n    //before compile\n    public class Node\u003cT\u003e {\n      private T data;\n      private Node\u003cT\u003e next;\n\n      public Node(T data, Node\u003cT\u003e next){\n        this.data = data;\n        this.next = next;\n      }\n\n      public T getData(){\n        return data;\n      }\n    }\n    //after compile\n    public class Node {\n      private Object data;\n      private Node next;\n\n      public Node(Object data, Node next){\n        this.data = data;\n        this.next = next;\n      }\n\n      public Object getData(){\n        return data;\n      }\n    }\n    ```\n    - 이 규칙에 의해 내가 처음 작성했던 코드가 컴파일 이후에는 `(Object)` 이런식으로 캐스팅하도록 변경됨을 알았음\n      이때, Object는 java 모든 클래스의 상위 클래스이기 때문에 원래 의도하던 객체가 아닌 String이 리턴된다고 해도 예외가 발생할리가 없었다.\n  - 두번째 규칙 : type 안정성을 지키기 위해서 type cast를 추가해준다\n  이 경우 `data = (T) result.get(\"data\");` 대신 `data = (String) result.get(\"data\");` 과 같이 명시적 형변환 할 때 타입을 명시하라는 의도이지만  \n  내가 작성되는 메소드의 리턴 데이터 타입을 이 곳에 명시할 수는 없어서 최종적으로 다음 챕터 코드처럼 수정했음\n\n### 수정한 코드\n```java\npublic static \u003cT\u003e T getData(MyObject myObject, Class\u003cT\u003e resultType) throws CustomException{\n  JSONParser parser = new JSONParser();\n  JSONObject result;\n  T data;\n\n  try{\n    result = (JSONObject) parser.parse(myObject.getPayload());\n    data = resultType.cast(result.get(\"data\"));\n  } catch(ParseException e) {\n    e.printStackTrace();\n    throw new CustomException(404, e.getMessage());\n  } catch(ClassCastException e){\n    throw new CustomException(500, e.getMessage());\n  }\n\n  return data;\n}\n```\n---\nGeneric에 대해서 분명히 취업전에 공부했는데, 막상 실제 업무 코드에 적용하는 것도 그렇고 컴파일 뒤에 어떻게 되는지도 그렇고  \n아직 알아야할 것이 많음을 느꼈다.\n","title":"What happens when jdk compiles the generic type \u003cT\u003e","date":"2022-08-16","category":["backend","java"],"tag":["Generic","Type Erasure","ClassCastException"]},"prev":{"id":"20220803","title":"Linux에서 .conf 파일의 주석으로 사용 가능한 문자열","date":"2022-08-03","category":["os","linux"],"tag":["beanstalk","springboot","nginx"]},"next":{"id":"20221020","title":"Ubuntu 명령어 정리","date":"2022-10-20","category":["os","linux"],"tag":["command"]}},"__N_SSG":true},"page":"/blog/[postId]","query":{"postId":"20220816"},"buildId":"K1CNs86QEQb419ZsPasnT","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>